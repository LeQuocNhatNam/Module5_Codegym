<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<body>
<div th:replace="layout::navbar"></div>
<div>
    <h2 style="text-align: center">Customer List</h2>
    <a th:href="@{/customer/create}" class="btn btn-primary">Create Customer</a>
    <h3 style="color: blue" th:text="${success}"></h3>
    <form method="get" th:action="@{/customer}">
        <input type="text" name="name" placeholder="name" th:value="${name}">
        <input type="text" name="email" placeholder="email" th:value="${email}">
        <select name="customerTypeId">
            <option th:text="${customerTypeId==0}? All:${customerTypeList.get(customerTypeId - 1).name}"
                    th:value="${customerTypeId==0}? 0: ${customerTypeId}"
            ></option>
            <option th:if="${customerTypeId!=0}" th:value="0" th:text="All"></option>
            <div th:each="customerType: ${customerTypeList}">
                <option th:if="${customerType.id != customerTypeId}"
                        th:value="${customerType.id}"
                        th:text="${customerType.name}"></option>
            </div>
        </select>
        <button class="btn btn-primary">Search</button>
    </form>
    <table class="table table-stripped">
        <tr>
            <th>#</th>
            <th>Name</th>
            <th>Date of Birth</th>
            <th>Gender</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>Customer type</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
        <tr th:each="customer,status:${customerPage}">
            <td th:text="${status.count}"></td>
            <td th:text="${customer.name}"></td>
            <td th:text="${customer.dateOfBirth}"></td>
            <td th:text="${customer.gender == true} ? Male : Female"></td>
            <td th:text="${customer.email}"></td>
            <td th:text="${customer.phoneNumber}"></td>
            <td th:text="${customer.customerType.name}"></td>
            <td><a class="btn btn-secondary" th:href="@{/customer/edit(id=${customer.getId()})}">Edit</a></td>
            <td>
                <button th:attr="onclick=|info('${customer.getId()}','${customer.name}')|" type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal">
                    Delete
                </button>
            </td>
        </tr>
    </table>
    <div>
        <span th:if="${customerPage.hasPrevious()}">
            <a th:href="@{/customer(name=${name},email=${email},customerTypeId=${customerTypeId},page=${customerPage.number}-1)}"
               th:text="Previous"></a>
        </span>
        <span th:text="${customerPage.number+1} + '/' + ${customerPage.totalPages}"></span>
        <span th:if="${customerPage.hasNext()}">
            <a th:href="@{/customer(name=${name},email=${email},customerTypeId=${customerTypeId},page=${customerPage.number + 1})}"
               th:text="Next"></a>
        </span>
    </div>
    <div th:replace="layout::modal"></div>
</div>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
<script>
    function info(id, name){
        document.getElementById("modal-body").innerText= "are you sure to delete " + name;
        document.getElementById("idDeleted").value = id;
    }
</script>
</html>
